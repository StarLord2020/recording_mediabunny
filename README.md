# Mediabunny UMD Demo: Long WebM Remux (RU)

Этот демо‑проект позволяет записывать и собирать большие WebM‑видео из чанков IndexedDB без упора в ОЗУ, с поддержкой прямой записи в файл (File System Access API), а также с fallback‑вариантами.

- Главная: `public/index.html` (исходник: `demo/index.html`)
  - Запись экрана → сборка в один файл (StreamSource → файл)
  - Обработка уже записанной сессии (выбор из IndexedDB → файл)
  - Прогресс‑бары: Индексация (sizes/prefix) и Байтовый (отдача данных источником)

- Сессии: `public/sessions.html` (исходник: `demo/sessions.html`)
  - Работа только с уже записанными сессиями
  - 4 прогресса: 1) Индексация → 2) Чтение (байты) → 3) Прогресс библиотеки → 4) Финализация
  - Кнопка “Скачать по частям (≈ N ГБ)” — делит на полноценные WebM‑файлы по окнам времени, чтобы не упираться в память

- Отладка: `public/alt.html` (исходник: `demo/alt.html`)
  - Режимы для проверки потоков, запись в файл, паддинг

- Сервис (ES‑модуль): `public/services/remuxService.js` (исходник: `demo/services/remuxService.js`)
  - Методы: листинг сессий, индексация, StreamSource, ремакс в файл/Blob, ремакс окна (trim)
  - Прогрессы: onIndexProgress, onByteProgress, onProgress (библиотека)

Подробности и инструкции
- HOWTO (как пользоваться, сборка, сценарии): `docs/HOWTO_RU.md`
- Технические заметки по состоянию: `docs/SESSION_NOTES_RU.md`
- План улучшений и идеи: `docs/ROADMAP_RU.md`

Сборка
```
npm install
npm run build
# Затем откройте public/index.html или public/sessions.html в браузере
```

## Почему так устроено

- Индексация (sizes/prefix) + StreamSource даёт «виртуальный файл» с произвольным доступом и стабильными пиками памяти.
- Байтовый прогресс показывает движение сразу после индексации — нет «тишины», пока библиотека вычисляет длительность.
- “По частям” без FS API/Service Worker позволяет скачивать гигабайтные записи в несколько файлов, минимизируя ОЗУ.

## Ограничения

- Без File System Access API (Firefox/Safari) потоковая запись в один файл недоступна. Используйте “по частям” или небольшие Blob’ы.
- “По частям” медленнее, чем запись в один файл, из‑за повторных инициализаций/финализаций. Выбирайте части покрупнее (2–4 ГБ).

